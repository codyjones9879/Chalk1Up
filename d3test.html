<!DOCTYPE html>
<html>
  <head>
    <title>D3 Test</title>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <style type ="text/css">
      path {
        stroke: steelblue;
        stroke-width: 2;
        fill: lightsteelblue;
      }
      line {
        stroke: steelblue;
      }
      text {
        font-family: Arial;
        font-size: 10pt;
      }
    </style>
    <script>
      function randomArray(size) {
        var dataRan = []
          dataRan.push(0)
          for(i=0; i<size; i++) {
            dataRan.push(Math.round(Math.random()*20))
          }
          dataRan.push(0)
          console.log(dataRan)
          return dataRan
      }
      function randomizeGraph1() {
        graphArray = randomArray(20)
        d3.select(".graph1").selectAll("p")
            .data(graphArray)
      }
    </script>
  </head>
  <body style="width:450px">
    Hello world!<br>
      <br>
    <h2>Line Graph:</h2>
    <p class="graph1"></p>
    <button onclick="randomizeGraph1(); return true;" href="#">Noop (for now)</button>
    <br>
    <h2>Random Dots:</h2>
    <p style="border:2px solid steelblue" class="graph2"></p>
    <p>Bla!</p>

    <script type="text/javascript">
      var dataA = randomArray(20)
      w = 400;
      h = 200;
      margin = 40;
      y = d3.scale.linear().domain([0, d3.max(dataA)]).range([0+margin, h-margin]);
      x = d3.scale.linear().domain([0, dataA.length]).range([0 + margin, w - margin]);

      var vis = d3.select(".graph1")
          .append("svg:svg")
          .attr("width", w)
          .attr("height", h)

      var g = vis.append("svg:g")
          .attr("transform", "translate(0, 200)");

      var line = d3.svg.line()
          .x(function(d,i) {return x(i); })
          .y(function(d) {return -1 * y(d); });

      g.append("svg:path").attr("d", line(dataA));

      g.append("svg:line")
          .attr("x1", x(0))
          .attr("y1", -1 * y(0))
          .attr("x2", x(w))
          .attr("y2", -1 * y(0))

      g.append("svg:line")
          .attr("x1", x(0))
          .attr("y1", -1 * y(0))
          .attr("x2", x(0))
          .attr("y2", -1 * y(d3.max(dataA)))

      g.selectAll(".xLabel")
          .data(x.ticks(5))
          .enter().append("svg:text")
          .attr("class", "xLabel")
          .text(String)
          .attr("x", function(d) { return x(d) })
          .attr("y", 0)
          .attr("text-anchor", "middle")

      g.selectAll(".yLabel")
          .data(y.ticks(4))
          .enter().append("svg:text")
          .attr("class", "yLabel")
          .text(String)
          .attr("x", 0)
          .attr("y", function(d) { return -1 * y(d) })
          .attr("text-anchor", "right")
          .attr("dy", 4)

      g.selectAll(".xTicks")
          .data(x.ticks(5))
          .enter().append("svg:line")
          .attr("class", "xTicks")
          .attr("x1", function(d) {return x(d); })
          .attr("x1", function(d) { return x(d); })
          .attr("y1", -1 * y(0))
          .attr("x2", function(d) { return x(d); })
          .attr("y2", -1 * y(-0.3))

      g.selectAll(".yTicks")
          .data(y.ticks(4))
          .enter().append("svg:line")
          .attr("class", "yTicks")
          .attr("y1", function(d) { return -1 * y(d); })
          .attr("x1", x(-0.3))
          .attr("y2", function(d) { return -1 * y(d); })
          .attr("x2", x(0))
    </script>
    <script type="text/javascript">
      var data = []
      for (i=0; i < 75; i++) {
          data.push({"x": Math.random(), "y": Math.random()})
      }
      var h = 350
      var vis = d3.select(".graph2")
          .append("svg:svg")
          .attr("width", screen.width)
          .attr("height", h)
      var x = d3.scale.linear().domain([0,1]).range([50, 350])  //[screen.width / 2 - 400,screen.width / 2 + 400]),
      y = d3.scale.linear().domain([0,1]).range([0,h]),
      r = d3.scale.linear().domain([0,1]).range([5,10]),
      c = d3.scale.linear().domain([0,1]).range(["hsl(175, 50%, 50%)", "hsl(275, 100%, 50%)"]).interpolate(d3.interpolateHsl)
       
      vis.selectAll("circle")
          .data(data)
          .enter().append("svg:circle")
          .attr("cx", function(d) { return x(d.x) })
          .attr("cy", function(d) { return y(d.y) })
          .attr("stroke-width", "none")
          .attr("fill", function() { return c(Math.random()) })
          .attr("fill-opacity", .5)
          .attr("visibility", "hidden")
          .attr("r", function() { return r(Math.random()) })
          .on("mouseout", function() {
              d3.select(this).transition()
              .attr("cy", function() { return y2(Math.random()) })
              .delay(0)
              .duration(2000)
              .ease("elastic", 10, 0.3)
          })
          .on("click", function() {
              d3.select(this).transition()
                .attr("r", function(d) {return Math.random()*30+10})
                .delay(0)
                .duration(500)
          })

      var y2 = d3.scale.linear().domain([0,1]).range([h/2 - 20, h/2 + 20])
      var del = d3.scale.linear().domain([0,1]).range([0,5])
       
      d3.selectAll("circle").transition()
          .attr("cx", function() { return x(Math.random()) })
          .attr("cy", function() { return y2(Math.random()) })
          .attr("visibility", "visible")
          .delay(function(d,i) { return i * del(Math.random()) })
          .duration(1000)
          .ease("elastic", 10, 2.0)
    </script>
  </body>
</html>